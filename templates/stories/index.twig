{% include 'components/html_head.twig' with {'css': 'stories', 'title':'stories'} %}
{% include 'components/navbar.twig' %}

<body>
<main id="swup" class="__stories__">
    <section class="grid head">
        <div class="intro">
            <div class="intro_text">
                <h1>Our Stories</h1>
                <p>Collections of articles centered around a specific place or theme</p>
            </div>
            <div class="intro_image">
                {% set randomEntries = craft.Entries.section('story').orderBy('RANDOM()').limit(3) %}
                <div class="slider">
                    <div class="progress">
                        {% for slide in randomEntries.all() %}
                            <div class="indicator"><div class="circle {% if loop.first %}active{% endif %}"></div></div>
                        {% endfor %}
                    </div>

                    <div class="slides">
                        {% for slide in randomEntries.all() %}
                            <a href="{{ slide.url }}">
                                <div class="slide">
                                    <div class="image" style="background-image: url({{ get_image_from_media(slide.storyImage, 875, 550) }});"></div>
                                    <div class="caption">{{ slide.title }}</div>
                                </div>
                            </a>
                        {% endfor %}
                    </div>
                </div>
             </div>
        </div>
    </section>
    <section class="stories grid">
        {%- set main_story =  craft.Entries.section('story').orderBy('postDate desc').one() -%}

        <div class="featured_story">
            <div class="title">
                <h1 class='md-only'> <a href="{{ main_story.url }}">{{- main_story -}}</a> </h1>
                <h2 class='tight sm-only'> <a href="{{ main_story.url }}">{{- main_story -}}</a> </h2>
                <p> {{ main_story.storyDescription }}</p>
                <div class="metadata caption">
                    {% if main_story.storyDates %}{{- main_story.storyDates -}} - {% endif %}
                    {% if main_story.storyLocation %}{{- main_story.storyLocation -}} - {% endif %}
                    {{- main_story.chapterList | length -}}&nbsp;{{- main_story.chapterList | length == 1 ? 'Chapter' : 'Chapters' -}}
                </div>
                <div class="read_more">
                    <a href="{{ main_story.url }}">Read More</a>
                </div>
            </div>
            <a href="{{ main_story.url }}" class="image" style="background-image: url({{ get_image_from_media(main_story.storyImage, 875, 550) }})"></a>

        </div>

        <div class="more_stories">
            {%- set stories =  craft.Entries.section('story').orderBy('postDate desc').limit(6).offset(1) -%}
            {%- for story in stories.all() -%}
                <div class="story_block">
                    <a href="{{ story.url }}"
                       class="image"
                       style="background-image: url({{ get_image_from_media(story.storyImage, 700, 550) }})">
                    </a>
                    <h2 class="tight"><a href="{{ story.url }}"> {{ story }} </a></h2>
                    <div class="metadata caption">
                        {% if story.storyDates %}{{- story.storyDates -}} - {% endif %}
                        {% if story.storyLocation %}{{- story.storyLocation -}} - {% endif %}
                        {{- story.chapterList | length -}}&nbsp;{{- story.chapterList | length == 1 ? 'Chapter' : 'Chapters' -}}
                    </div>
                    <div class="read_more">
                        <a href="{{ story.url }}">Read More</a>
                    </div>
                </div>
            {%- endfor -%}

        </div>

    </section>
{% include 'components/share.twig' %}
{% include 'components/footer.twig' %}
</main>
</body>
